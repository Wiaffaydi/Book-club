{% extends 'core/base.html' %}
{% load static %}

{% block title %}{{ book.title }} - Книжковий клуб{% endblock %}

{% block extra_css %}
<link href="{% static 'core/css/pages/book_detail.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="book-detail">
    <div class="book-header">
        <div class="book-cover">
            {% if book.thumbnail %}
                <img src="{{ book.thumbnail }}" alt="{{ book.title }}">
            {% else %}
                <img src="https://via.placeholder.com/300x450?text=No+Image" alt="{{ book.title }}">
            {% endif %}
        </div>
        <div class="book-info">
            <h1 class="book-title">{{ book.title }}</h1>
            <div class="book-meta">
                <span><i class="fas fa-user"></i> {{ book.author }}</span>
                <span><i class="fas fa-calendar"></i> {{ book.published_year }}</span>
                <span><i class="fas fa-tag"></i> {{ book.genre }}</span>
            </div>
            <div class="book-description">
                {{ book.description|striptags|linebreaks }}
            </div>
            <div class="book-actions">
                <a href="{{ book.preview_link }}" target="_blank" class="btn btn-preview">
                    <i class="fas fa-book-open"></i> Читати книгу
                </a>
            </div>
        </div>
    </div>

    <!-- Секция комментариев -->
    <div class="comments-section">
        <h2 class="comments-title">Коментарі</h2>
        
        {% if user.is_authenticated %}
            <form method="post" class="comment-form">
                {% csrf_token %}
                {{ comment_form.text }}
                <button type="submit" class="btn btn-primary">Додати коментар</button>
            </form>
        {% else %}
            <div class="login-message">
                <p>Будь ласка, <a href="{% url 'login' %}">увійдіть</a> або <a href="{% url 'register' %}">зареєструйтесь</a>, щоб залишити коментар.</p>
            </div>
        {% endif %}

        <div class="comments-list">
            {% for comment in comments %}
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">{{ comment.user.username }}</span>
                        <span class="comment-date">{{ comment.created_at|date:"d.m.Y H:i" }}</span>
                    </div>
                    <div class="comment-text">
                        {{ comment.text|linebreaks }}
                    </div>
                </div>
            {% empty %}
                <div class="comment">
                    <p class="comment-text">Ще немає коментарів. Будьте першим!</p>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %} 